<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Provides a convenient way to analyze and visualize PICRUSt2 output with pre-defined plots and functions. Allows for generating statistical plots about microbiome functional predictions and offers customization options. Features a one-click option for creating publication-level plots, saving time and effort in producing professional-grade figures. Streamlines the PICRUSt2 analysis and visualization process. For more details, see Yang et al. (2023) &lt;arXiv:2303.10388&gt;.">
<title>Make PICRUSt2 Output Analysis and Visualization Easier • ggpicrust2</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Make PICRUSt2 Output Analysis and Visualization Easier">
<meta property="og:description" content="Provides a convenient way to analyze and visualize PICRUSt2 output with pre-defined plots and functions. Allows for generating statistical plots about microbiome functional predictions and offers customization options. Features a one-click option for creating publication-level plots, saving time and effort in producing professional-grade figures. Streamlines the PICRUSt2 analysis and visualization process. For more details, see Yang et al. (2023) &lt;arXiv:2303.10388&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">ggpicrust2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.10</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cafferychen777/ggpicrust2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="ggpicrust2-documentation">ggpicrust2 Documentation<a class="anchor" aria-label="anchor" href="#ggpicrust2-documentation"></a>
</h1></div>
<p><em>ggpicrust2</em> is a comprehensive package that integrates pathway name/description annotations, ten of the most advanced differential abundance (DA) methods, and visualization of DA results. It offers a comprehensive solution for analyzing and interpreting the results of PICRUSt2 functional prediction in a seamless and intuitive way. Whether you are a researcher, data scientist, or bioinformatician, <em>ggpicrust2</em> can help you better understand the underlying biological processes and mechanisms at play in your PICRUSt2 output data. So if you are interested in exploring the output data of PICRUSt2, <em>ggpicrust2</em> is the tool you need.</p>
<p><a href="https://CRAN.R-project.org/package=ggpicrust2" class="external-link"><img src="https://www.r-pkg.org/badges/version/ggpicrust2" alt="CRAN version"></a> <a href="https://CRAN.R-project.org/package=ggpicrust2" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/ggpicrust2" alt="Downloads"></a> <a href="https://opensource.org/licenses/MIT" class="external-link"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a></p>
<div class="section level2">
<h2 id="table-of-contents">Table of Contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h2>
<ul>
<li><a href="#citation">Citation</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#stay-updated">Stay Updated</a></li>
<li><a href="#workflow">Workflow</a></li>
<li><a href="#output">Output</a></li>
<li>
<a href="#function-details">Function Details</a>
<ul>
<li><a href="#ko2kegg_abundance">ko2kegg_abundance()</a></li>
<li><a href="#pathway_daa">pathway_daa()</a></li>
<li><a href="#pathway_annotation">pathway_annotation()</a></li>
<li><a href="#pathway_errorbar">pathway_errorbar()</a></li>
<li><a href="#pathway_heatmap">pathway_heatmap()</a></li>
<li><a href="#pathway_pca">pathway_pca()</a></li>
</ul>
</li>
<li><a href="#authors-other-projects">Author’s Other Projects</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use <em>ggpicrust2</em> in your research, please cite the following paper:</p>
<p>Chen Yang, Aaron Burberry, Jiahao Mai, Liangliang Zhang. (2023). <a href="https://arxiv.org/abs/2303.10388" class="external-link">ggpicrust2: an R package for PICRUSt2 predicted functional profile analysis and visualization.</a> arXiv preprint arXiv:2303.10388.</p>
<p>BibTeX entry: @misc{yang2023ggpicrust2, title={ggpicrust2: an R package for PICRUSt2 predicted functional profile analysis and visualization}, author={Chen Yang and Aaron Burberry and Jiahao Mai and Liangliang Zhang}, year={2023}, eprint={2303.10388}, archivePrefix={arXiv}, primaryClass={stat.AP} }</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the stable version of <em>ggpicrust2</em> from CRAN with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggpicrust2"</span><span class="op">)</span></span></code></pre></div>
<p>To install the latest development version of <em>ggpicrust2</em> from GitHub, you can use:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install the devtools package if not already installed</span></span>
<span><span class="co"># install.packages("devtools")</span></span>
<span></span>
<span><span class="co"># Install ggpicrust2 from GitHub</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"cafferychen777/ggpicrust2"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="stay-updated">Stay Updated<a class="anchor" aria-label="anchor" href="#stay-updated"></a>
</h2>
<p>Follow me on Twitter for the latest <em>ggpicrust2</em> updates: <a href="https://twitter.com/CafferyYang" class="external-link"><img src="https://img.shields.io/twitter/follow/CafferyYang?style=social"></a></p>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>The easiest way to analyze the PICRUSt2 output is using ggpicrust2() function. The entire pipeline can be run with ggpicrust2() function.</p>
<p>ggpicrust2() integrates ko abundance to kegg pathway abundance conversion, annotation of pathway, differential abundance (DA) analysis, DA results visualization.</p>
<p><img src="https://cafferychen777.github.io/ggpicrust2/reference/figures/ggpicrust2%20fig1.jpeg"></p>
<p><img src="https://cafferychen777.github.io/ggpicrust2/reference/figures/ggpicrust2%20fig2.jpeg"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#If you want to analysis kegg pathway abundance instead of ko within the pathway. You should turn ko_to_kegg to TRUE.</span></span>
<span><span class="co">#The kegg pathway typically have the more explainable description.</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">read_delim</span><span class="op">(</span></span>
<span>    <span class="st">"~/Microbiome/C9orf72/Code And Data/new_metadata.txt"</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>    escape_double <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    trim_ws <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="st">"Enviroment"</span></span>
<span><span class="va">daa_results_list</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/ggpicrust2.html">ggpicrust2</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="st">"/Users/apple/Microbiome/C9orf72/Code And Data/picrust2_out/KO_metagenome_out/pred_metagenome_unstrat.tsv/pred_metagenome_unstrat.tsv"</span>,</span>
<span>    metadata <span class="op">=</span> <span class="va">metadata</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"Enviroment"</span>,</span>
<span>    pathway <span class="op">=</span> <span class="st">"KO"</span>,</span>
<span>    daa_method <span class="op">=</span> <span class="st">"LinDA"</span>,</span>
<span>    order <span class="op">=</span> <span class="st">"pathway_class"</span>,</span>
<span>    ko_to_kegg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    x_lab <span class="op">=</span> <span class="st">"pathway_name"</span>,</span>
<span>    p.adjust <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>    select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    reference <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#The visualization will be published in viewer.</span></span>
<span></span>
<span><span class="co">#If you want to analysis the EC. MetaCyc. KO without conversions. You should turn ko_to_kegg to FALSE.</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">read_delim</span><span class="op">(</span></span>
<span>    <span class="st">"~/Microbiome/C9orf72/Code And Data/new_metadata.txt"</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>    escape_double <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    trim_ws <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="st">"Enviroment"</span></span>
<span><span class="va">daa_results_list</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/ggpicrust2.html">ggpicrust2</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="st">"//Users/apple/Microbiome/C9orf72/Code And Data/picrust2_out/EC_metagenome_out/pred_metagenome_unstrat.tsv/pred_metagenome_unstrat.tsv"</span>,</span>
<span>    metadata <span class="op">=</span> <span class="va">metadata</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"Enviroment"</span>,</span>
<span>    pathway <span class="op">=</span> <span class="st">"EC"</span>,</span>
<span>    daa_method <span class="op">=</span> <span class="st">"LinDA"</span>,</span>
<span>    order <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>    ko_to_kegg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    x_lab <span class="op">=</span> <span class="st">"description"</span>,</span>
<span>    p.adjust <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>    select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    reference <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#The visualization will be published in viewer.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h2>
<p>The typical output of the ggpicrust2 is like this.</p>
<p><img src="https://cdn.jsdelivr.ren/gh/cafferychen777/ggpicrust2_paper@main/paper_figure/figure1.jpg"></p>
</div>
<div class="section level2">
<h2 id="function-details">function details<a class="anchor" aria-label="anchor" href="#function-details"></a>
</h2>
<div class="section level3">
<h3 id="ko2kegg_abundance">ko2kegg_abundance()<a class="anchor" aria-label="anchor" href="#ko2kegg_abundance"></a>
</h3>
<p>KEGG Orthology(KO) is a classification system developed by the Kyoto Encyclopedia of Genes and Genomes (KEGG) data-base(Kanehisa et al., 2022). It uses a hierarchical structure to classify enzymes based on the reactions they catalyze. To better understand pathways’ role in different groups and classify the pathways, the KO abundance table needs to be converted to KEGG pathway abundance. But PICRUSt2 removes the function from PICRUSt. ko2kegg_abundance() can help convert the table.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample usage of the ko2kegg_abundance function</span></span>
<span></span>
<span><span class="co"># Assume that the KO abundance table is stored in a file named "ko_abundance.tsv"</span></span>
<span></span>
<span><span class="va">ko_abundance_file</span> <span class="op">&lt;-</span> <span class="st">"ko_abundance.tsv"</span></span>
<span></span>
<span><span class="va">kegg_abundance</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ko2kegg_abundance.html">ko2kegg_abundance</a></span><span class="op">(</span><span class="va">ko_abundance_file</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The resulting kegg_abundance data frame can now be used for further analysis and visualization.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pathway_daa">pathway_daa()<a class="anchor" aria-label="anchor" href="#pathway_daa"></a>
</h3>
<p>Differential abundance(DA) analysis plays a major role in PICRUSt2 downstream analysis. pathway_daa() integrates almost all DA methods applicable to the predicted functional profile which there excludes ANCOM and ANCOMBC. It includes <a href="https://bioconductor.riken.jp/packages/3.9/bioc/html/ALDEx2.html" class="external-link">ALDEx2</a>(Fernandes et al., 2013), <a href="https://bioconductor.org/packages/release/bioc/html/DESeq2.html" class="external-link">DEseq2</a>(Love et al., 2014), <a href="https://www.bioconductor.org/packages/release/bioc/html/Maaslin2.html" class="external-link">Maaslin2</a>(Mallick et al., 2021), <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-022-02655-5" class="external-link">LinDA</a>(Zhou et al., 2022), <a href="https://bioconductor.org/packages/release/bioc/html/edgeR.html" class="external-link">edgeR</a>(Robinson et al., 2010) , <a href="https://ucdavis-bioinformatics-training.github.io/2018-June-RNA-Seq-Workshop/thursday/DE.html" class="external-link">limma voom</a>(Ritchie et al., 2015), <a href="https://www.bioconductor.org/packages/release/bioc/html/metagenomeSeq.html#:~:text=metagenomeSeq%20is%20designed%20to%20address,the%20testing%20of%20feature%20correlations." class="external-link">metagenomeSeq</a>(Paulson et al., 2013), <a href="http://bioconductor.org/packages/release/bioc/html/lefser.html" class="external-link">lefser</a>(Segata et al., 2011).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#the abundance table is better to be data.frame rather than tibble</span></span>
<span><span class="co">#you can use ko2_kegg_abundance output</span></span>
<span><span class="va">abundance</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ko2kegg_abundance.html">ko2kegg_abundance</a></span><span class="op">(</span><span class="va">ko_abundance_file</span><span class="op">)</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">read_delim</span><span class="op">(</span></span>
<span>    <span class="st">"~/Microbiome/C9orf72/Code And Data/new_metadata.txt"</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>    escape_double <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    trim_ws <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="st">"Enviroment"</span></span>
<span><span class="co">#daa_method default is "ALDex2"</span></span>
<span><span class="va">daa_results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pathway_daa.html">pathway_daa</a></span><span class="op">(</span>abundance <span class="op">=</span> <span class="va">abundance</span>,</span>
<span>           metadata <span class="op">=</span> <span class="va">metadata</span>,</span>
<span>           group <span class="op">=</span> <span class="va">group</span> ,</span>
<span>           daa_method <span class="op">=</span> <span class="st">"limma voom"</span>,</span>
<span>           select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>           p.adjust <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>           reference <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#If you group levels &gt;3 and want to use the LinDA or limma voom, you should give a reference.</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">read_delim</span><span class="op">(</span></span>
<span>    <span class="st">"~/Microbiome/C9orf72/Code And Data/new_metadata.txt"</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>    escape_double <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    trim_ws <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="st">"Group"</span></span>
<span><span class="va">daa_results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pathway_daa.html">pathway_daa</a></span><span class="op">(</span>abundance <span class="op">=</span> <span class="va">abundance</span>,</span>
<span>           metadata <span class="op">=</span> <span class="va">metadata</span>,</span>
<span>           group <span class="op">=</span> <span class="va">group</span> ,</span>
<span>           daa_method <span class="op">=</span> <span class="st">"limma voom"</span>,</span>
<span>           select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>           p.adjust <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>           reference <span class="op">=</span> <span class="st">"Harvard BRI"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pathway_annotation">pathway_annotation()<a class="anchor" aria-label="anchor" href="#pathway_annotation"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">daa_results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pathway_annotation.html">pathway_annotation</a></span><span class="op">(</span>pathway <span class="op">=</span> <span class="st">"KO"</span>, daa_results_df <span class="op">=</span> <span class="va">daa_results_df</span>, ko_to_kegg <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pathway_errorbar">pathway_errorbar()<a class="anchor" aria-label="anchor" href="#pathway_errorbar"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/pathway_errorbar.html">pathway_errorbar</a></span><span class="op">(</span>abundance <span class="op">=</span> <span class="va">abundance</span>,</span>
<span>           daa_results_df <span class="op">=</span> <span class="va">daa_results_df</span>,</span>
<span>           Group <span class="op">=</span> <span class="va">metadata</span><span class="op">$</span><span class="va">Enviroment</span>,</span>
<span>           ko_to_kegg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           p_values_threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>           order <span class="op">=</span> <span class="st">"pathway_class"</span>,</span>
<span>           select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>           p_value_bar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>           x_lab <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pathway_heatmap">pathway_heatmap()<a class="anchor" aria-label="anchor" href="#pathway_heatmap"></a>
</h3>
<p>In this section, we will demonstrate how to create a pathway heatmap using the <code>pathway_heatmap</code> function in the ggpicrust2 package. This function visualizes the relative abundance of pathways in different samples.</p>
<p>First, we will create some example functional pathway abundance data and metadata:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create example functional pathway abundance data</span></span>
<span><span class="va">abundance_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">abundance_example</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">abundance_example</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PathwayA"</span>, <span class="st">"PathwayB"</span>, <span class="st">"PathwayC"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create example metadata</span></span>
<span><span class="co"># Please change your sample id's column name to sample_name</span></span>
<span><span class="va">metadata_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sample_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">abundance_example</span><span class="op">)</span>,</span>
<span>                               group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Treatment"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next, we will use the pathway_heatmap function to create a heatmap:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a heatmap</span></span>
<span><span class="va">heatmap_plot</span> <span class="op">&lt;-</span> <span class="fu">ggpicrust2</span><span class="fu">::</span><span class="fu"><a href="reference/pathway_heatmap.html">pathway_heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">abundance_example</span><span class="op">)</span>, <span class="va">metadata_example</span>, <span class="st">"group"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we will display the resulting heatmap:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">heatmap_plot</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pathway_pca">pathway_pca()<a class="anchor" aria-label="anchor" href="#pathway_pca"></a>
</h3>
<p>In this section, we will demonstrate how to perform Principal Component Analysis (PCA) on functional pathway abundance data and create visualizations of the PCA results using the <code>pathway_pca</code> function in the ggpicrust2 package.</p>
<p>First, we will create some example functional pathway abundance data and metadata:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create example functional pathway abundance data</span></span>
<span><span class="va">abundance_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create example metadata</span></span>
<span><span class="va">metadata_example</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>sample_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>                                   group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Treatment"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next, we will use the pathway_pca function to perform PCA and create visualizations:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform PCA and create visualizations</span></span>
<span><span class="va">pca_plot</span> <span class="op">&lt;-</span> <span class="fu">ggpicrust2</span><span class="fu">::</span><span class="fu"><a href="reference/pathway_pca.html">pathway_pca</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">abundance_example</span><span class="op">)</span>, <span class="va">metadata_example</span>, <span class="st">"group"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we will display the resulting PCA plot:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pca_plot</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="authors-other-projects">Author’s other projects<a class="anchor" aria-label="anchor" href="#authors-other-projects"></a>
</h2>
<p><a href="https://a95dps-caffery-chen.shinyapps.io/MicrobiomeGallery/" class="external-link">MicrobiomeGallery</a>, a web-based platform for sharing microbiome data visualization code and datasets. （It’s still under construction）</p>
<p><img src="https://raw.githubusercontent.com/cafferychen777/ggpicrust2_paper/main/paper_figure/MicrobiomeGallery_preview.jpg"></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=ggpicrust2" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/cafferychen777/ggpicrust2/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/cafferychen777/ggpicrust2/pulls" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ggpicrust2</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Chen Yang <br><small class="roles"> Author, maintainer </small>  </li>
<li>Liangliang Zhang <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Chen Yang, Liangliang Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
